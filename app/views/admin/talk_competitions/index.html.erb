<% content_for :breadcrumb do %>
<li><%= link_to @activity.name, "#" %></li>
<% end %>

<div class="row">
  <div class="col-sm-12">
    <div class="nest">
      <div class="col-sm-12 pull-right text-right">
        <%= link_to print_admin_activity_talk_competitions_path(activity_id: @activity.id) do %>
          <i class="icon-print"></i>打印汇总
        <% end %>
      </div>
      <div class="body-nest">
        <div class="scroll-table-container">
          <table class="table table-bordered table-hover table-striped">
            <thead>
              <tr>
                <th>序号</th>
                <th>参赛项目</th>
                <th>姓名</th>
                <th>课程名称</th>
                <th>邮箱</th>
                <th>手机</th>
                <th>上传作品</th>
                <th>分配评委</th>
              </tr>
            </thead>
            <tbody>
              <% @recruits.each_with_index do |recruit, index| -%>
                <tr>
                  <td><%= index+1 %></td>
                  <td><%= recruit.project %></td>
                  <td><%= recruit.try(:player).try(:info).try(:name) %></td>
                  <td><%= recruit.name -%></td>
                  <td><%= recruit.try(:player).try(:info).try(:email) %></td>
                  <td><%= recruit.try(:player).try(:phone) %></td>
                  <td>
                    <% if recruit.opus.present? %>
                      <span class="glyphicon glyphicon-ok text-success"></span>
                    <% else %>
                      <span class="glyphicon glyphicon-remove text-danger"></span>
                    <% end %>
                  </td>
                  <td>
                    <% if recruit.marks.present? %>
                      <% recruit.marks.each do |mark| %>
                        <%= link_to mark.expert.try(:user_info).try(:name), "#", class: "btn btn-xs btn-success" %>
                      <% end %>
                    <% else %>
                      <%= link_to "分配评委", distribution_admin_activity_recruit_path(params[:activity_id], recruit), remote: true, format: :js, class: "btn btn-xs btn-primary" %>
                    <% end %>
                  </td> 
                </tr>
              <% end -%>
            </tbody>
          </table>
        </div>


        <div class="text-center">
          <div class="pagination pagination-centered">
            <div class='row'><%= will_paginate @recruits, :renderer => BootstrapPagination::Rails ,:remote => {:update => 'messages'} %></div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<%= render partial: "/admin/share/admin_modal" %>
